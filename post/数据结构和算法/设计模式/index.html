<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>è®¾è®¡æ¨¡å¼ - ZsmHub - Blog</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="ZsmHub" /><meta name="description" content="è®¾è®¡æ¨¡å¼ç®€ä»‹ è®¾è®¡æ¨¡å¼ä¸€å¥—è¢«åå¤ä½¿ç”¨ï¼Œå¤šæ•°äººçŸ¥æ™“çš„ä»£ç è®¾è®¡ç»éªŒçš„æ€»ç»“ï¼Œå®ç°å¯é‡ç”¨ä»£ç ï¼Œä½¿ä»£ç æ›´å®¹æ˜“è¢«ç†è§£ï¼Œä¿è¯ä»£ç å¯é æ€§ã€‚ æ€»ä½“æ¥è¯´ï¼Œè®¾è®¡æ¨¡å¼åˆ†" /><meta name="keywords" content="Hugo, even, zsmhub, blog, php, golang" />






<meta name="generator" content="Hugo 0.82.0 with theme even" />


<link rel="canonical" href="https://zsmhub.github.io/post/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.eb0308f0e54ff86bb150b0f7f2912dd5f4eb4f67b1ee508094605ecd5b7dd679.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="è®¾è®¡æ¨¡å¼" />
<meta property="og:description" content="è®¾è®¡æ¨¡å¼ç®€ä»‹ è®¾è®¡æ¨¡å¼ä¸€å¥—è¢«åå¤ä½¿ç”¨ï¼Œå¤šæ•°äººçŸ¥æ™“çš„ä»£ç è®¾è®¡ç»éªŒçš„æ€»ç»“ï¼Œå®ç°å¯é‡ç”¨ä»£ç ï¼Œä½¿ä»£ç æ›´å®¹æ˜“è¢«ç†è§£ï¼Œä¿è¯ä»£ç å¯é æ€§ã€‚ æ€»ä½“æ¥è¯´ï¼Œè®¾è®¡æ¨¡å¼åˆ†" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zsmhub.github.io/post/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2020-02-15T21:05:40&#43;08:00" />
<meta property="article:modified_time" content="2020-02-15T21:05:40&#43;08:00" />

<meta itemprop="name" content="è®¾è®¡æ¨¡å¼">
<meta itemprop="description" content="è®¾è®¡æ¨¡å¼ç®€ä»‹ è®¾è®¡æ¨¡å¼ä¸€å¥—è¢«åå¤ä½¿ç”¨ï¼Œå¤šæ•°äººçŸ¥æ™“çš„ä»£ç è®¾è®¡ç»éªŒçš„æ€»ç»“ï¼Œå®ç°å¯é‡ç”¨ä»£ç ï¼Œä½¿ä»£ç æ›´å®¹æ˜“è¢«ç†è§£ï¼Œä¿è¯ä»£ç å¯é æ€§ã€‚ æ€»ä½“æ¥è¯´ï¼Œè®¾è®¡æ¨¡å¼åˆ†"><meta itemprop="datePublished" content="2020-02-15T21:05:40&#43;08:00" />
<meta itemprop="dateModified" content="2020-02-15T21:05:40&#43;08:00" />
<meta itemprop="wordCount" content="2866">
<meta itemprop="keywords" content="è®¾è®¡æ¨¡å¼," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="è®¾è®¡æ¨¡å¼"/>
<meta name="twitter:description" content="è®¾è®¡æ¨¡å¼ç®€ä»‹ è®¾è®¡æ¨¡å¼ä¸€å¥—è¢«åå¤ä½¿ç”¨ï¼Œå¤šæ•°äººçŸ¥æ™“çš„ä»£ç è®¾è®¡ç»éªŒçš„æ€»ç»“ï¼Œå®ç°å¯é‡ç”¨ä»£ç ï¼Œä½¿ä»£ç æ›´å®¹æ˜“è¢«ç†è§£ï¼Œä¿è¯ä»£ç å¯é æ€§ã€‚ æ€»ä½“æ¥è¯´ï¼Œè®¾è®¡æ¨¡å¼åˆ†"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">ZsmHub Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">é¦–é¡µ</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">å½’æ¡£</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">åˆ†ç±»</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">æ ‡ç­¾</li>
      </a><a href="/navigation">
        <li class="mobile-menu-item">å¯¼èˆª</li>
      </a><a href="/about">
        <li class="mobile-menu-item">å…³äº</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">ZsmHub Blog</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">é¦–é¡µ</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">å½’æ¡£</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">åˆ†ç±»</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">æ ‡ç­¾</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/navigation">å¯¼èˆª</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about">å…³äº</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">è®¾è®¡æ¨¡å¼</h1>

      <div class="post-meta">
        <span class="post-time"> 2020-02-15 </span>
        <div class="post-category">
            <a href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95/"> æ•°æ®ç»“æ„å’Œç®—æ³• </a>
            </div>
          <span class="more-meta"> çº¦ 2866 å­— </span>
          <span class="more-meta"> é¢„è®¡é˜…è¯» 6 åˆ†é’Ÿ </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">æ–‡ç« ç›®å½•</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#è®¾è®¡æ¨¡å¼ç®€ä»‹">è®¾è®¡æ¨¡å¼ç®€ä»‹</a></li>
    <li><a href="#å¸¸è§çš„è®¾è®¡æ¨¡å¼">å¸¸è§çš„è®¾è®¡æ¨¡å¼</a></li>
    <li><a href="#å·¥ä½œæ¡ˆä¾‹">å·¥ä½œæ¡ˆä¾‹</a></li>
    <li><a href="#å‚è€ƒæ–‡ç« ">å‚è€ƒæ–‡ç« </a></li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <h2 id="è®¾è®¡æ¨¡å¼ç®€ä»‹">è®¾è®¡æ¨¡å¼ç®€ä»‹</h2>
<p>è®¾è®¡æ¨¡å¼ä¸€å¥—è¢«åå¤ä½¿ç”¨ï¼Œå¤šæ•°äººçŸ¥æ™“çš„ä»£ç è®¾è®¡ç»éªŒçš„æ€»ç»“ï¼Œå®ç°å¯é‡ç”¨ä»£ç ï¼Œä½¿ä»£ç æ›´å®¹æ˜“è¢«ç†è§£ï¼Œä¿è¯ä»£ç å¯é æ€§ã€‚</p>
<blockquote>
<p>æ€»ä½“æ¥è¯´ï¼Œè®¾è®¡æ¨¡å¼åˆ†ä¸ºä¸‰å¤§ç±»ï¼š</p>
</blockquote>
<ul>
<li>åˆ›å»ºå‹æ¨¡å¼ï¼ˆäº”ç§ï¼‰ï¼šå•ä¾‹æ¨¡å¼ã€å·¥å‚æ¨¡å¼ã€æŠ½è±¡å·¥å‚æ¨¡å¼ã€åˆ›å»ºè€…æ¨¡å¼ã€åŸå‹æ¨¡å¼</li>
<li>ç»“æ„å‹æ¨¡å¼ï¼ˆä¸ƒç§ï¼‰ï¼šé€‚é…å™¨æ¨¡å¼ã€ä»£ç†æ¨¡å¼ã€è£…é¥°å™¨æ¨¡å¼ã€å¤–è§‚æ¨¡å¼ã€æ¡¥æ¥æ¨¡å¼ã€ç»„åˆæ¨¡å¼ã€äº«å…ƒæ¨¡å¼</li>
<li>è¡Œä¸ºå‹æ¨¡å¼ï¼ˆåä¸€ç§ï¼‰ï¼šç­–ç•¥æ¨¡å¼ã€æ¨¡æ¿æ–¹æ³•æ¨¡å¼ã€è§‚å¯Ÿè€…æ¨¡å¼ã€è¿­ä»£å­æ¨¡å¼ã€è´£ä»»é“¾æ¨¡å¼ã€å‘½ä»¤æ¨¡å¼ã€å¤‡å¿˜å½•æ¨¡å¼ã€çŠ¶æ€æ¨¡å¼ã€è®¿é—®è€…æ¨¡å¼ã€ä¸­ä»‹è€…æ¨¡å¼ã€è§£é‡Šå™¨æ¨¡å¼ã€‚</li>
</ul>
<blockquote>
<p>ç®—æ³•æ‰§è¡Œçš„æ­¥éª¤æ˜¯ç¨³å®šä¸å˜çš„ï¼Œä½†æ˜¯å…·ä½“çš„æŸäº›ç®—æ³•å¯èƒ½å­˜åœ¨å˜åŒ–çš„åœºæ™¯ã€‚</p>
</blockquote>
<p>æ€ä¹ˆç†è§£ï¼Œä¸¾ä¸ªä¾‹å­ï¼šæ¯”å¦‚è¯´ä½ ç…®ä¸ªé¢ï¼Œå¿…ç„¶éœ€è¦å…ˆçƒ§æ°´ï¼Œæ°´çƒ§å¼€ä¹‹åå†æ”¾é¢è¿›å»ï¼Œä»¥ä¸Šçš„æµç¨‹æˆ‘ä»¬ç§°ä¹‹ä¸ºç…®é¢è¿‡ç¨‹ã€‚å¯çŸ¥ï¼šè¿™ä¸ªç…®é¢è¿‡ç¨‹çš„æ­¥éª¤æ˜¯ç¨³å®šä¸å˜çš„ï¼Œä½†æ˜¯åœ¨ä¸åŒçš„ç¯å¢ƒçƒ§æ°´çš„æ–¹å¼å¯èƒ½ä¸å°½ç›¸åŒï¼Œä¹Ÿè®¸æœ‰çš„äººç”¨å¤©ç„¶æ°”çƒ§æ°´ã€æœ‰çš„äººç”¨ç”µç£ç‚‰çƒ§æ°´ã€æœ‰çš„äººç”¨æŸ´ç«çƒ§æ°´ï¼Œç­‰ç­‰ã€‚æˆ‘ä»¬å¯ä»¥å¾—åˆ°ä»¥ä¸‹ç»“è®ºï¼š</p>
<ul>
<li>ç…®é¢è¿‡ç¨‹çš„æ­¥éª¤æ˜¯ç¨³å®šä¸å˜çš„</li>
<li>ç…®é¢è¿‡ç¨‹çš„çƒ§æ°´æ–¹å¼æ˜¯å¯å˜çš„</li>
</ul>
<h2 id="å¸¸è§çš„è®¾è®¡æ¨¡å¼">å¸¸è§çš„è®¾è®¡æ¨¡å¼</h2>
<ol>
<li>
<p>å•ä¾‹æ¨¡å¼ï¼ˆæœ€ç®€å•çš„ä¸€ç§è®¾è®¡æ¨¡å¼ï¼‰</p>
<p>ä½¿ç”¨æ‡’æƒ°æ¨¡å¼çš„å•ä¾‹æ¨¡å¼ï¼Œä½¿ç”¨åŒé‡æ£€æŸ¥åŠ é”ä¿è¯çº¿ç¨‹å®‰å…¨ã€å¯¹è±¡ä»…å®ä¾‹åŒ–ä¸€æ¬¡ã€</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="kd">type</span> <span class="nx">CustomValidator</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="nx">once</span>     <span class="nx">sync</span><span class="p">.</span><span class="nx">Once</span>
    <span class="nx">validate</span> <span class="o">*</span><span class="nx">validator</span><span class="p">.</span><span class="nx">Validate</span>
<span class="p">}</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">c</span> <span class="o">*</span><span class="nx">CustomValidator</span><span class="p">)</span> <span class="nf">Validate</span><span class="p">(</span><span class="nx">v</span> <span class="kd">interface</span><span class="p">{})</span> <span class="kt">error</span> <span class="p">{</span>
    <span class="nx">c</span><span class="p">.</span><span class="nf">lazyInit</span><span class="p">()</span>
    <span class="k">return</span> <span class="nx">c</span><span class="p">.</span><span class="nx">validate</span><span class="p">.</span><span class="nf">Struct</span><span class="p">(</span><span class="nx">v</span><span class="p">)</span>
<span class="p">}</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">c</span> <span class="o">*</span><span class="nx">CustomValidator</span><span class="p">)</span> <span class="nf">lazyInit</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">c</span><span class="p">.</span><span class="nx">once</span><span class="p">.</span><span class="nf">Do</span><span class="p">(</span><span class="kd">func</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">c</span><span class="p">.</span><span class="nx">validate</span> <span class="p">=</span> <span class="nx">validator</span><span class="p">.</span><span class="nf">New</span><span class="p">()</span>
    <span class="p">})</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>å·¥å‚æ¨¡å¼ vs æŠ½è±¡å·¥å‚æ¨¡å¼</p>
<blockquote>
<p>å®šä¹‰</p>
</blockquote>
<ul>
<li>å·¥å‚æ¨¡å¼ å®šä¹‰ä¸€ä¸ªç”¨äºåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè®©å­ç±»å†³å®šå®ä¾‹åŒ–å“ªä¸€ä¸ªç±»</li>
<li>æŠ½è±¡å·¥å‚æ¨¡å¼ ä¸ºåˆ›å»ºä¸€ç»„ç›¸å…³æˆ–ç›¸äº’ä¾èµ–çš„å¯¹è±¡æä¾›ä¸€ä¸ªæ¥å£ï¼Œè€Œä¸”æ— éœ€æŒ‡å®šä»–ä»¬çš„å…·ä½“ç±»</li>
</ul>
<blockquote>
<p>åŒºåˆ«</p>
</blockquote>
<p>å·¥å‚æ¨¡å¼é’ˆå¯¹çš„æ˜¯ä¸€ä¸ªäº§å“ç­‰çº§ç»“æ„ ï¼ŒæŠ½è±¡å·¥å‚æ¨¡å¼é’ˆå¯¹çš„æ˜¯é¢å‘å¤šä¸ªäº§å“ç­‰çº§ç»“æ„çš„ã€‚ã€ç¤ºä¾‹ï¼šåœ¨æ¯ä¸€ä¸ªå±‚æ¬¡ï¼Œç§èœå·¥äººæ‰€å…³å¿ƒçš„å¯¹è±¡ä¹Ÿä¸ä¸€æ ·ï¼Œåœ¨ç®€å•å·¥å‚æ¨¡å¼ä¸‹ï¼Œå·¥äººè¦æƒ³åˆ°ç§æ¤èåœè¿˜æ˜¯ç™½èœï¼Œåœ¨å·¥å‚æ¨¡å¼ä¸‹ï¼Œå·¥äººæƒ³åˆ°æ˜¯ç§æ¤æ ¹èœè¿˜æ˜¯èŒèœï¼Œè€Œåœ¨æŠ½è±¡å·¥å‚æ¨¡å¼ä¸‹ï¼Œåˆ™å…³å¿ƒç§æ¤åŸºå› èœè¿˜æ˜¯éåŸºå› èœã€‚ã€</p>
<p><img src="/images/2020/QQ20201130-174630.png" alt="å·¥å‚æ¨¡å¼å’ŒæŠ½è±¡å·¥å‚æ¨¡å¼çš„åŒºåˆ«"></p>
<p><img src="/images/2020/QQ20201130-175923.png" alt="ç¤ºä¾‹1"></p>
<p><img src="/images/2020/QQ20201130-175958.png" alt="ç¤ºä¾‹2">)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="c1">//Operator æ˜¯è¢«å°è£…çš„å®é™…ç±»æ¥å£
</span><span class="c1"></span><span class="kd">type</span> <span class="nx">Operator</span> <span class="kd">interface</span> <span class="p">{</span>
    <span class="nf">SetA</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span>
    <span class="nf">Result</span><span class="p">()</span> <span class="kt">int</span>
<span class="p">}</span>

<span class="kd">type</span> <span class="nx">OperatorB</span> <span class="kd">interface</span> <span class="p">{</span>
    <span class="nf">SetB</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span>
    <span class="nf">Result</span><span class="p">()</span> <span class="kt">int</span>
<span class="p">}</span>

<span class="c1">//OperatorFactory é‡‡ç”¨äº†å·¥å‚æ¨¡å¼
</span><span class="c1"></span><span class="kd">type</span> <span class="nx">OperatorFactory</span> <span class="kd">interface</span> <span class="p">{</span>
    <span class="nf">Create</span><span class="p">()</span> <span class="nx">Operator</span> <span class="c1">// ç§èœ
</span><span class="c1"></span><span class="p">}</span>

<span class="c1">//OperatorFactory é‡‡ç”¨äº†æŠ½è±¡å·¥å‚æ¨¡å¼
</span><span class="c1"></span><span class="kd">type</span> <span class="nx">OperatorFactory2</span> <span class="kd">interface</span> <span class="p">{</span>
    <span class="nf">CreateA</span><span class="p">()</span> <span class="nx">Operator</span>  <span class="c1">// ç§æ ¹èœ
</span><span class="c1"></span>    <span class="nf">CreateB</span><span class="p">()</span> <span class="nx">OperatorB</span> <span class="c1">// ç§èŠ¹èœ
</span><span class="c1"></span><span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>åˆ›å»ºè€…æ¨¡å¼</p>
<p>åº”ç”¨åœºæ™¯ï¼šä¸€äº›åŸºæœ¬ç»„ä»¶ä¸ä¼šå˜ï¼Œè€Œå…¶ç»„åˆç»å¸¸å˜åŒ–çš„æ—¶å€™ã€‚ã€æœ‰ç›¸åŒçš„æ¥å£æ–¹æ³•ï¼Œä½†å„è‡ªæ‹¥æœ‰ç‰¹æ®Šçš„æ¥å£æ–¹æ³•ã€</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="kd">type</span> <span class="nx">Builder</span> <span class="kd">interface</span> <span class="p">{</span>
    <span class="nf">Part1</span><span class="p">()</span>
    <span class="nf">Part2</span><span class="p">()</span>
<span class="p">}</span>

<span class="kd">type</span> <span class="nx">Director</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="nx">builder</span> <span class="nx">Builder</span>
<span class="p">}</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">d</span> <span class="o">*</span><span class="nx">Director</span><span class="p">)</span> <span class="nf">Construct</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">d</span><span class="p">.</span><span class="nx">builder</span><span class="p">.</span><span class="nf">Part1</span><span class="p">()</span>
    <span class="nx">d</span><span class="p">.</span><span class="nx">builder</span><span class="p">.</span><span class="nf">Part2</span><span class="p">()</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">NewDirector</span><span class="p">(</span><span class="nx">builder</span> <span class="nx">Builder</span><span class="p">)</span> <span class="o">*</span><span class="nx">Director</span> <span class="p">{</span>
    <span class="k">return</span> <span class="o">&amp;</span><span class="nx">Director</span><span class="p">{</span>
        <span class="nx">builder</span><span class="p">:</span> <span class="nx">builder</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">type</span> <span class="nx">Builder1</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="nx">result</span> <span class="kt">string</span>
<span class="p">}</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">b</span> <span class="o">*</span><span class="nx">Builder1</span><span class="p">)</span> <span class="nf">Part1</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">b</span><span class="p">.</span><span class="nx">result</span> <span class="o">+=</span> <span class="s">&#34;1&#34;</span>
<span class="p">}</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">b</span> <span class="o">*</span><span class="nx">Builder1</span><span class="p">)</span> <span class="nf">Part2</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">b</span><span class="p">.</span><span class="nx">result</span> <span class="o">+=</span> <span class="s">&#34;2&#34;</span>
<span class="p">}</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">b</span> <span class="o">*</span><span class="nx">Builder1</span><span class="p">)</span> <span class="nf">GetResult</span><span class="p">()</span> <span class="kt">string</span> <span class="p">{</span> <span class="c1">// Builder1 ç‰¹æ®Šæ–¹æ³•
</span><span class="c1"></span>    <span class="k">return</span> <span class="nx">b</span><span class="p">.</span><span class="nx">result</span>
<span class="p">}</span>

<span class="kd">type</span> <span class="nx">Builder2</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="nx">result</span> <span class="kt">int</span>
<span class="p">}</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">b</span> <span class="o">*</span><span class="nx">Builder2</span><span class="p">)</span> <span class="nf">Part1</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">b</span><span class="p">.</span><span class="nx">result</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="p">}</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">b</span> <span class="o">*</span><span class="nx">Builder2</span><span class="p">)</span> <span class="nf">Part2</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">b</span><span class="p">.</span><span class="nx">result</span> <span class="o">+=</span> <span class="mi">2</span>
<span class="p">}</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">b</span> <span class="o">*</span><span class="nx">Builder2</span><span class="p">)</span> <span class="nf">GetResult2</span><span class="p">()</span> <span class="kt">int</span> <span class="p">{</span> <span class="c1">// Builder2 ç‰¹æ®Šæ–¹æ³•
</span><span class="c1"></span>    <span class="k">return</span> <span class="nx">b</span><span class="p">.</span><span class="nx">result</span>
<span class="p">}</span>

<span class="c1">// æµ‹è¯•ç”¨ä¾‹
</span><span class="c1"></span><span class="kd">func</span> <span class="nf">TestBuilder1</span><span class="p">(</span><span class="nx">t</span> <span class="o">*</span><span class="nx">testing</span><span class="p">.</span><span class="nx">T</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">builder</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="nx">Builder1</span><span class="p">{}</span>
    <span class="nx">director</span> <span class="o">:=</span> <span class="nf">NewDirector</span><span class="p">(</span><span class="nx">builder</span><span class="p">)</span>
    <span class="nx">director</span><span class="p">.</span><span class="nf">Construct</span><span class="p">()</span>
    <span class="nx">res</span> <span class="o">:=</span> <span class="nx">builder</span><span class="p">.</span><span class="nf">GetResult</span><span class="p">()</span>
    <span class="k">if</span> <span class="nx">res</span> <span class="o">!=</span> <span class="s">&#34;12&#34;</span> <span class="p">{</span>
        <span class="nx">t</span><span class="p">.</span><span class="nf">Fatalf</span><span class="p">(</span><span class="s">&#34;Builder1 fail expect 12 acture %s&#34;</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">func</span> <span class="nf">TestBuilder2</span><span class="p">(</span><span class="nx">t</span> <span class="o">*</span><span class="nx">testing</span><span class="p">.</span><span class="nx">T</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">builder</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="nx">Builder2</span><span class="p">{}</span>
    <span class="nx">director</span> <span class="o">:=</span> <span class="nf">NewDirector</span><span class="p">(</span><span class="nx">builder</span><span class="p">)</span>
    <span class="nx">director</span><span class="p">.</span><span class="nf">Construct</span><span class="p">()</span>
    <span class="nx">res</span> <span class="o">:=</span> <span class="nx">builder</span><span class="p">.</span><span class="nf">GetResult</span><span class="p">()</span>
    <span class="k">if</span> <span class="nx">res</span> <span class="o">!=</span> <span class="mi">3</span> <span class="p">{</span>
        <span class="nx">t</span><span class="p">.</span><span class="nf">Fatalf</span><span class="p">(</span><span class="s">&#34;Builder2 fail expect 3 acture %d&#34;</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>é€‚é…å™¨æ¨¡å¼ vs è£…é¥°å™¨æ¨¡å¼</p>
<blockquote>
<p>é€‚é…å™¨æ¨¡å¼ï¼šæŠ›å¼ƒæ—§æ¥å£é€»è¾‘ï¼Œè®¿é—®æ—§æ¥å£æ—¶ç›´æ¥è°ƒè½¬åˆ°è¯·æ±‚æ–°æ¥å£</p>
</blockquote>
<p>æ„å›¾ï¼šå°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·å¸Œæœ›çš„å¦å¤–ä¸€ä¸ªæ¥å£ã€‚é€‚é…å™¨æ¨¡å¼ä½¿å¾—åŸæœ¬ç”±äºæ¥å£ä¸å…¼å®¹è€Œä¸èƒ½ä¸€èµ·å·¥ä½œçš„é‚£äº›ç±»å¯ä»¥ä¸€èµ·å·¥ä½œã€‚
ä¸»è¦è§£å†³ï¼šä¸»è¦è§£å†³åœ¨è½¯ä»¶ç³»ç»Ÿä¸­ï¼Œå¸¸å¸¸è¦å°†ä¸€äº›&quot;ç°å­˜çš„å¯¹è±¡&quot;æ”¾åˆ°æ–°çš„ç¯å¢ƒä¸­ï¼Œè€Œæ–°ç¯å¢ƒè¦æ±‚çš„æ¥å£æ˜¯ç°å¯¹è±¡ä¸èƒ½æ»¡è¶³çš„ã€‚</p>
<p>ä¼˜ç‚¹ï¼š 1ã€å¯ä»¥è®©ä»»ä½•ä¸¤ä¸ªæ²¡æœ‰å…³è”çš„ç±»ä¸€èµ·è¿è¡Œã€‚ 2ã€æé«˜äº†ç±»çš„å¤ç”¨ã€‚ 3ã€å¢åŠ äº†ç±»çš„é€æ˜åº¦ã€‚ 4ã€çµæ´»æ€§å¥½ã€‚</p>
<p>ç¼ºç‚¹ï¼š è¿‡å¤šåœ°ä½¿ç”¨é€‚é…å™¨ï¼Œä¼šè®©ç³»ç»Ÿéå¸¸é›¶ä¹±ï¼Œä¸æ˜“æ•´ä½“è¿›è¡ŒæŠŠæ¡ã€‚æ¯”å¦‚ï¼Œæ˜æ˜çœ‹åˆ°è°ƒç”¨çš„æ˜¯ A æ¥å£ï¼Œå…¶å®å†…éƒ¨è¢«é€‚é…æˆäº† B æ¥å£çš„å®ç°ï¼Œä¸€ä¸ªç³»ç»Ÿå¦‚æœå¤ªå¤šå‡ºç°è¿™ç§æƒ…å†µï¼Œæ— å¼‚äºä¸€åœºç¾éš¾ã€‚å› æ­¤å¦‚æœä¸æ˜¯å¾ˆæœ‰å¿…è¦ï¼Œå¯ä»¥ä¸ä½¿ç”¨é€‚é…å™¨ï¼Œè€Œæ˜¯ç›´æ¥å¯¹ç³»ç»Ÿè¿›è¡Œé‡æ„ã€‚</p>
<p>ä½¿ç”¨åœºæ™¯ï¼šæœ‰åŠ¨æœºåœ°ä¿®æ”¹ä¸€ä¸ªæ­£å¸¸è¿è¡Œçš„ç³»ç»Ÿçš„æ¥å£ï¼Œè¿™æ—¶åº”è¯¥è€ƒè™‘ä½¿ç”¨é€‚é…å™¨æ¨¡å¼ã€‚</p>
<blockquote>
<p>è£…é¥°å™¨æ¨¡å¼ï¼šç»§æ‰¿æ—§æ¥å£é€»è¾‘ï¼Œæ–°æ¥å£è·å–æ—§æ¥å£è¿”å›å€¼åï¼Œå¢åŠ æ–°çš„è¡¥å……é€»è¾‘</p>
</blockquote>
<p>è£…é¥°æ¨¡å¼ä½¿ç”¨å¯¹è±¡ç»„åˆçš„æ–¹å¼åŠ¨æ€æ”¹å˜æˆ–å¢åŠ å¯¹è±¡è¡Œä¸ºã€‚</p>
</li>
<li>
<p>ä»£ç†æ¨¡å¼</p>
<p>ä»£ç†æ¨¡å¼ç”¨äºå»¶è¿Ÿå¤„ç†æ“ä½œæˆ–è€…åœ¨è¿›è¡Œå®é™…æ“ä½œå‰åè¿›è¡Œå…¶å®ƒå¤„ç†ã€‚</p>
<p>å®é™…æ¡ˆä¾‹ï¼šå¦‚æ§åˆ¶å™¨å±‚è°ƒç”¨ä¸šåŠ¡å±‚çš„æ–¹æ³•å‰ï¼Œå¯ä»¥åšä¸€äº›å‚æ•°éªŒè¯(å¦‚ä¸­é—´ä»¶)ç­‰ï¼Œè°ƒç”¨ä¸šåŠ¡å±‚çš„æ–¹æ³•åï¼Œå†åšä¸€äº›æ•°æ®å°è£…ç­‰ï¼Œæœ€ç»ˆè¾“å‡ºç»“æœã€‚æ•´ç†æµç¨‹æ¥çœ‹ï¼Œæ§åˆ¶å™¨å±‚çš„ç”¨æ³•å°±æ˜¯ä»£ç†æ¨¡å¼ã€‚</p>
</li>
<li>
<p>æ¨¡æ¿æ¨¡å¼</p>
<p>æŠ½è±¡ç±»é‡Œå®šä¹‰å¥½ç®—æ³•çš„æ‰§è¡Œæ­¥éª¤å’Œå…·ä½“ç®—æ³•ï¼Œä»¥åŠå¯èƒ½å‘ç”Ÿå˜åŒ–çš„ç®—æ³•å®šä¹‰ä¸ºæŠ½è±¡æ–¹æ³•ã€‚ä¸åŒçš„å­ç±»ç»§æ‰¿è¯¥æŠ½è±¡ç±»ï¼Œå¹¶å®ç°çˆ¶ç±»çš„æŠ½è±¡æ–¹æ³•ã€‚</p>
<blockquote>
<p>æ¨¡æ¿æ¨¡å¼çš„ä¼˜åŠ¿ï¼š</p>
</blockquote>
<ul>
<li>ä¸å˜çš„ç®—æ³•è¢«ç»§æ‰¿å¤ç”¨ï¼šä¸å˜çš„éƒ¨åˆ†é«˜åº¦å°è£…ã€å¤ç”¨ã€‚</li>
<li>å˜åŒ–çš„ç®—æ³•å­ç±»ç»§æ‰¿å¹¶å…·ä½“å®ç°ï¼šå˜åŒ–çš„éƒ¨åˆ†å­ç±»åªéœ€è¦å…·ä½“å®ç°æŠ½è±¡çš„éƒ¨åˆ†å³å¯ï¼Œæ–¹ä¾¿æ‰©å±•ï¼Œä¸”å¯æ— é™æ‰©å±•ã€‚</li>
</ul>
</li>
<li>
<p>èŒè´£é“¾æ¨¡å¼ vs ç»„åˆæ¨¡å¼</p>
<blockquote>
<p>èŒè´£é“¾æ¨¡å¼</p>
</blockquote>
<p>é¦–å…ˆæŠŠä¸€ç³»åˆ—ä¸šåŠ¡æŒ‰èŒè´£åˆ’åˆ†æˆä¸åŒçš„å¯¹è±¡ï¼Œæ¥ç€æŠŠè¿™ä¸€ç³»åˆ—å¯¹è±¡æ„æˆä¸€ä¸ªé“¾ï¼Œç„¶ååœ¨è¿™ä¸€ç³»åˆ—å¯¹è±¡ä¸­ä¼ é€’è¯·æ±‚å¯¹è±¡ï¼Œç›´åˆ°è¢«å¤„ç†ä¸ºæ­¢ã€‚</p>
<p>å…·ä½“ä¼˜åŠ¿ï¼š</p>
<ul>
<li>ç›´è§‚ï¼šä¸€çœ¼å¯è§‚çš„ä¸šåŠ¡è°ƒç”¨è¿‡ç¨‹</li>
<li>æ— é™æ‰©å±•ï¼šå¯æ— é™æ‰©å±•çš„ä¸šåŠ¡é€»è¾‘</li>
<li>é«˜åº¦å°è£…ï¼šå¤æ‚ä¸šåŠ¡ä»£ç ä¾ç„¶é«˜åº¦å°è£…</li>
<li>ææ˜“è¢«ä¿®æ”¹ï¼šå¤æ‚ä¸šåŠ¡ä»£ç ä¸‹ä¿®æ”¹ä»£ç åªéœ€è¦ä¸“æ³¨å¯¹åº”çš„ä¸šåŠ¡ç±»(ç»“æ„ä½“)æ–‡ä»¶å³å¯ï¼Œä»¥åŠææ˜“è¢«è°ƒæ•´çš„ä¸šåŠ¡æ‰§è¡Œé¡ºåº</li>
</ul>
<blockquote>
<p>ã€ŒèŒè´£é“¾æ¨¡å¼ã€ ä¸ã€Œç»„åˆæ¨¡å¼ã€çš„åŒºåˆ«ï¼š</p>
</blockquote>
<ul>
<li>èŒè´£é“¾æ¨¡å¼: é“¾è¡¨</li>
<li>ç»„åˆæ¨¡å¼ï¼šæ ‘</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="c1">// èŒè´£é“¾æ¨¡å¼-å•†åŸè´­ç‰©ä¸‹å•ä¸šåŠ¡ç¤ºä¾‹
</span><span class="c1">// Context Context
</span><span class="c1"></span><span class="kd">type</span> <span class="nx">Context</span> <span class="kd">struct</span> <span class="p">{</span>
<span class="p">}</span>

<span class="c1">// Handler å¤„ç†
</span><span class="c1"></span><span class="kd">type</span> <span class="nx">Handler</span> <span class="kd">interface</span> <span class="p">{</span>
    <span class="c1">// è‡ªèº«çš„ä¸šåŠ¡
</span><span class="c1"></span>    <span class="nf">Do</span><span class="p">(</span><span class="nx">c</span> <span class="o">*</span><span class="nx">Context</span><span class="p">)</span> <span class="kt">error</span>
    <span class="c1">// è®¾ç½®ä¸‹ä¸€ä¸ªå¯¹è±¡
</span><span class="c1"></span>    <span class="nf">SetNext</span><span class="p">(</span><span class="nx">h</span> <span class="nx">Handler</span><span class="p">)</span> <span class="nx">Handler</span>
    <span class="c1">// é€’å½’æ‰§è¡Œ
</span><span class="c1"></span>    <span class="nf">Run</span><span class="p">(</span><span class="nx">c</span> <span class="o">*</span><span class="nx">Context</span><span class="p">)</span> <span class="kt">error</span>
<span class="p">}</span>

<span class="c1">// Next æŠ½è±¡å‡ºæ¥çš„ å¯è¢«åˆæˆå¤ç”¨çš„ç»“æ„ä½“
</span><span class="c1"></span><span class="kd">type</span> <span class="nx">Next</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="c1">// ä¸‹ä¸€ä¸ªå¯¹è±¡
</span><span class="c1"></span>    <span class="nx">nextHandler</span> <span class="nx">Handler</span>
<span class="p">}</span>

<span class="c1">// SetNext å®ç°å¥½çš„ å¯è¢«å¤ç”¨çš„SetNextæ–¹æ³•
</span><span class="c1">// è¿”å›å€¼æ˜¯ä¸‹ä¸€ä¸ªå¯¹è±¡ æ–¹ä¾¿å†™æˆé“¾å¼ä»£ç ä¼˜é›…
</span><span class="c1">// ä¾‹å¦‚ nullHandler.SetNext(argumentsHandler).SetNext(signHandler).SetNext(frequentHandler)
</span><span class="c1"></span><span class="kd">func</span> <span class="p">(</span><span class="nx">n</span> <span class="o">*</span><span class="nx">Next</span><span class="p">)</span> <span class="nf">SetNext</span><span class="p">(</span><span class="nx">h</span> <span class="nx">Handler</span><span class="p">)</span> <span class="nx">Handler</span> <span class="p">{</span>
    <span class="nx">n</span><span class="p">.</span><span class="nx">nextHandler</span> <span class="p">=</span> <span class="nx">h</span>
    <span class="k">return</span> <span class="nx">h</span>
<span class="p">}</span>

<span class="c1">// Run æ‰§è¡Œ
</span><span class="c1"></span><span class="kd">func</span> <span class="p">(</span><span class="nx">n</span> <span class="o">*</span><span class="nx">Next</span><span class="p">)</span> <span class="nf">Run</span><span class="p">(</span><span class="nx">c</span> <span class="o">*</span><span class="nx">Context</span><span class="p">)</span> <span class="p">(</span><span class="nx">err</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// ç”±äºgoæ— ç»§æ‰¿çš„æ¦‚å¿µ è¿™é‡Œæ— æ³•æ‰§è¡Œå½“å‰handlerçš„Do
</span><span class="c1"></span>    <span class="c1">// n.Do(c)
</span><span class="c1"></span>    <span class="k">if</span> <span class="nx">n</span><span class="p">.</span><span class="nx">nextHandler</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="c1">// åˆæˆå¤ç”¨ä¸‹çš„å˜ç§
</span><span class="c1"></span>        <span class="c1">// æ‰§è¡Œä¸‹ä¸€ä¸ªhandlerçš„Do
</span><span class="c1"></span>        <span class="k">if</span> <span class="nx">err</span> <span class="p">=</span> <span class="p">(</span><span class="nx">n</span><span class="p">.</span><span class="nx">nextHandler</span><span class="p">).</span><span class="nf">Do</span><span class="p">(</span><span class="nx">c</span><span class="p">);</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
            <span class="k">return</span>
        <span class="p">}</span>
        <span class="c1">// æ‰§è¡Œä¸‹ä¸€ä¸ªhandlerçš„Run
</span><span class="c1"></span>        <span class="k">return</span> <span class="p">(</span><span class="nx">n</span><span class="p">.</span><span class="nx">nextHandler</span><span class="p">).</span><span class="nf">Run</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span>
<span class="p">}</span>

<span class="c1">// ArgumentsHandler æ ¡éªŒå‚æ•°çš„handler
</span><span class="c1"></span><span class="kd">type</span> <span class="nx">ArgumentsHandler</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="c1">// åˆæˆå¤ç”¨Next
</span><span class="c1"></span>    <span class="nx">Next</span>
<span class="p">}</span>

<span class="c1">// Do æ ¡éªŒå‚æ•°çš„é€»è¾‘
</span><span class="c1"></span><span class="kd">func</span> <span class="p">(</span><span class="nx">h</span> <span class="o">*</span><span class="nx">ArgumentsHandler</span><span class="p">)</span> <span class="nf">Do</span><span class="p">(</span><span class="nx">c</span> <span class="o">*</span><span class="nx">Context</span><span class="p">)</span> <span class="p">(</span><span class="nx">err</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nf">runFuncName</span><span class="p">(),</span> <span class="s">&#34;æ ¡éªŒå‚æ•°æˆåŠŸ...&#34;</span><span class="p">)</span>
    <span class="k">return</span>
<span class="p">}</span>

<span class="c1">// AddressInfoHandler åœ°å€ä¿¡æ¯handler
</span><span class="c1"></span><span class="kd">type</span> <span class="nx">AddressInfoHandler</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="c1">// åˆæˆå¤ç”¨Next
</span><span class="c1"></span>    <span class="nx">Next</span>
<span class="p">}</span>

<span class="c1">// Do æ ¡éªŒå‚æ•°çš„é€»è¾‘
</span><span class="c1"></span><span class="kd">func</span> <span class="p">(</span><span class="nx">h</span> <span class="o">*</span><span class="nx">AddressInfoHandler</span><span class="p">)</span> <span class="nf">Do</span><span class="p">(</span><span class="nx">c</span> <span class="o">*</span><span class="nx">Context</span><span class="p">)</span> <span class="p">(</span><span class="nx">err</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nf">runFuncName</span><span class="p">(),</span> <span class="s">&#34;è·å–åœ°å€ä¿¡æ¯...&#34;</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nf">runFuncName</span><span class="p">(),</span> <span class="s">&#34;åœ°å€ä¿¡æ¯æ ¡éªŒ...&#34;</span><span class="p">)</span>
    <span class="k">return</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">handler</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="nx">Next</span><span class="p">{}</span>

    <span class="c1">// é“¾å¼è°ƒç”¨
</span><span class="c1"></span>    <span class="nx">handler</span><span class="p">.</span><span class="nf">SetNext</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">ArgumentsHandler</span><span class="p">{}).</span>
        <span class="nf">SetNext</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">AddressInfoHandler</span><span class="p">{})</span>
        <span class="c1">//æ— é™æ‰©å±•ä»£ç ...
</span><span class="c1"></span>
    <span class="c1">// å¼€å§‹æ‰§è¡Œä¸šåŠ¡
</span><span class="c1"></span>    <span class="k">if</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">handler</span><span class="p">.</span><span class="nf">Run</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">Context</span><span class="p">{});</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Fail | Error:&#34;</span> <span class="o">+</span> <span class="nx">err</span><span class="p">.</span><span class="nf">Error</span><span class="p">())</span>
        <span class="k">return</span>
    <span class="p">}</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Success&#34;</span><span class="p">)</span>
    <span class="k">return</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>ç­–ç•¥æ¨¡å¼ vs çŠ¶æ€æ¨¡å¼</p>
<ul>
<li>ç­–ç•¥æ¨¡å¼ï¼šä¾é å®¢æˆ·å†³ç­–ï¼ˆå¦‚æ”¯ä»˜æ–¹å¼ï¼‰</li>
<li>çŠ¶æ€æ¨¡å¼ï¼šä¾é å†…éƒ¨çŠ¶æ€å†³ç­–ï¼ˆå¦‚åç«¯å‘é€çŸ­ä¿¡å•†çš„é€‰æ‹©ï¼‰</li>
</ul>
</li>
</ol>
<h2 id="å·¥ä½œæ¡ˆä¾‹">å·¥ä½œæ¡ˆä¾‹</h2>
<ol>
<li>
<p>Master-Workeræ¨¡å¼</p>
<p>å…¶æ˜¯å¸¸ç”¨çš„å¹¶è¡Œè®¾è®¡æ¨¡å¼ã€‚æ ¸å¿ƒæ€æƒ³æ˜¯ï¼Œç³»ç»Ÿç”±ä¸¤ä¸ªè§’è‰²ç»„æˆï¼ŒMasterå’ŒWorkerï¼ŒMasterè´Ÿè´£æ¥æ”¶å’Œåˆ†é…ä»»åŠ¡ï¼ŒWorkerè´Ÿè´£å¤„ç†å­ä»»åŠ¡ã€‚ä»»åŠ¡å¤„ç†è¿‡ç¨‹ä¸­ï¼ŒMasterè¿˜è´Ÿè´£ç›‘ç£ä»»åŠ¡è¿›å±•å’ŒWorkerçš„å¥åº·çŠ¶æ€ï¼›Masterå°†æ¥æ”¶Clientæäº¤çš„ä»»åŠ¡ï¼Œå¹¶å°†ä»»åŠ¡çš„è¿›å±•æ±‡æ€»åé¦ˆç»™Client</p>
<p><img src="/images/2020/QQ20200505-212528%402x.png" alt="å›¾ç‰‡"></p>
</li>
<li>
<p>å…¸å‹çš„å®¢æˆ·ç«¯ - æœåŠ¡ç«¯æ¨¡å¼</p>
</li>
</ol>
<h2 id="å‚è€ƒæ–‡ç« ">å‚è€ƒæ–‡ç« </h2>
<ul>
<li><a href="http://wen.topgoer.com/docs/golang-design-pattern/golang-design-pattern-1cbgha2ltg796">Goè¯­è¨€è®¾è®¡æ¨¡å¼</a></li>
<li><a href="http://tigerb.cn/go-patterns/#/">Goè®¾è®¡æ¨¡å¼å®æˆ˜</a></li>
<li><a href="https://cloud.tencent.com/developer/article/1523363">è®¾è®¡æ¨¡å¼ä¸­å·¥å‚æ–¹æ³•ä¸æŠ½è±¡å·¥å‚ä¹‹é—´çš„åŒºåˆ«è”ç³»</a></li>
</ul>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">æ–‡ç« ä½œè€…</span>
    <span class="item-content"><a href="https://zsmhub.github.io/" class="theme-link">ZsmHub</a></span>
  </p>
  <p class="copyright-item">
    <span class="item-title">ä¸Šæ¬¡æ›´æ–°</span>
    <span class="item-content">
        2020-02-15
        
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">è®¸å¯åè®®</span>
    <span class="item-content"><a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a></span>
  </p>
</div>
<div class="post-reward">
  <input type="checkbox" name="reward" id="reward" hidden />
  <label class="reward-button" for="reward">ğŸ‘ğŸ» å–œæ¬¢æ–‡ç«  ğŸ‘€</label>
  <div class="qr-code">
    
    <label class="qr-code-image" for="reward">
        <img class="image" src="/images/wechat-qr-code.png" alt="è¯·å…ˆç§‘å­¦ä¸Šç½‘">
        <span>å¾®ä¿¡æ‰“èµ</span>
      </label>
    <label class="qr-code-image" for="reward">
        <img class="image" src="/images/alipay-qr-code.png" alt="è¯·å…ˆç§‘å­¦ä¸Šç½‘">
        <span>æ”¯ä»˜å®æ‰“èµ</span>
      </label>
  </div>
</div><footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">è®¾è®¡æ¨¡å¼</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/%E9%9D%A2%E8%AF%95%E5%BF%85%E5%A4%87/sql%E9%9D%A2%E8%AF%95%E9%A2%98/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">SQL é¢è¯•é¢˜</span>
            <span class="prev-text nav-mobile">ä¸Šä¸€ç¯‡</span>
          </a>
        <a class="next" href="/post/%E9%9D%A2%E8%AF%95%E5%BF%85%E5%A4%87/%E9%9D%A2%E8%AF%95%E6%B1%87%E6%80%BB/">
            <span class="next-text nav-default">é¢è¯•æ±‡æ€»</span>
            <span class="next-text nav-mobile">ä¸‹ä¸€ç¯‡</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        <div id="gitalk-container"></div>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js" crossorigin="anonymous"></script>
    <script type="text/javascript">
      var gitalk = new Gitalk({
        id: '2020-02-15 21:05:40 \u002b0800 CST',
        title: 'è®¾è®¡æ¨¡å¼',
        clientID: 'fe63c88fe7fc18e38512',
        clientSecret: 'e44ced40487d261a6006f9af23a2f788bf1e0a85',
        repo: 'zsmhub.github.io',
        owner: 'zsmhub',
        admin: ['zsmhub'],
        body: decodeURI(location.href)
      });
      gitalk.render('gitalk-container');
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://github.com/gitalk/gitalk">comments powered by gitalk.</a></noscript>

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:zhangshimiande@email.com" class="iconfont icon-email" title="email"></a>
      <a href="https://github.com/zsmhub" class="iconfont icon-github" title="github"></a>
  <a href="https://zsmhub.github.io/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    ç”± <a class="hexo-link" href="https://gohugo.io">Hugo</a> å¼ºåŠ›é©±åŠ¨
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    ä¸»é¢˜ - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2019 - 
    2022
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">ZsmHub</span>
  </span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.cddea96674a99fd8cea50d36fb19d9c91f497feea4af5ce4596afd2dbaab9202.js"></script>








</body>
</html>
